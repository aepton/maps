{"version":3,"file":"component---src-pages-bikes-js-9ee102721d50aeb49717.js","mappings":"mKAKA,MAAMA,EAAa,CACjBC,MAAO,UACPC,QAAS,EACTC,WAAY,4CAGRC,EAAMC,IAAyC,IAAxC,KAAEC,EAAI,OAAEC,EAAM,QAAEC,EAAO,QAAEC,GAASJ,EAE7C,MAAMK,GAAUC,EAAAA,EAAAA,QAAO,MAIjBC,GAASD,EAAAA,EAAAA,QAAO,MA0EtB,OAxEAE,EAAAA,EAAAA,YAAU,KACR,IAAIC,EAAYP,EACZQ,EAAUT,EAEd,MAMMU,EAAM,IAAIC,EAAAA,IAAe,CAC7BC,UAAWR,EAAQS,QACnBC,MAPQ,mEAQRb,OAAQO,EACRR,KAAMS,EACNP,UACAC,YAoDF,OAlDAG,EAAOO,QAAUH,EAGjBA,EAAIK,GAAG,QAAQC,UACX,MAAMC,QAAiBC,MAAM,uCAC7B,IAAKD,EAASE,GACV,MAAM,IAAIC,MAAM,oBAAoBH,EAASI,UAGjD,MAAMC,QAAaL,EAASK,OAC5BC,QAAQC,IAAIF,GACZC,QAAQC,IAAIF,EAAKG,UACjBF,QAAQC,IAAgB,CACpBE,KAAM,UACNC,KAAM,CACFD,KAAM,oBACND,SAAUH,EAAKG,YAGvBf,EAAIkB,UACA,sBACA,CACIF,KAAM,UACNC,KAAM,CACFD,KAAM,oBACND,SAAUH,EAAKG,YAK3Bf,EAAImB,SAAS,CACT,GAAM,aACN,KAAQ,OACR,OAAU,sBACV,MAAS,CACL,aAAc,CAAC,MAAO,cACtB,eAAgB,GAChB,aAAc,KAItBN,QAAQC,IAAI,eACR,gBAAiBM,WACjBA,UAAUC,YAAYC,oBAAoBC,IACtCV,QAAQC,IAAI,eAAgBS,GAC5BvB,EAAIwB,UAAU,CAACD,EAASE,OAAOC,UAAWH,EAASE,OAAOE,UAAU,GAE5E,IAGG,KACL3B,EAAI4B,QAAQ,CACb,GACA,IACIC,EAAAA,cAAA,OAAKC,IAAKpC,EAASU,MAAO,CAAE2B,MAAO,QAASC,OAAQ,UAAa,EAQ1E5C,EAAI6C,aAAe,CACjB1C,OAAQ,EAAE,WAAY,WACtBD,KAAM,GACNE,QAAS,GAWX,UARkB0C,IAEdL,EAAAA,cAAA,QAAMzB,MAAOpB,GACX6C,EAAAA,cAACzC,EAAG,OAOH,MAAM+C,EAAOA,IAAMN,EAAAA,cAAA,aAAO,yB","sources":["webpack://maps/./src/pages/bikes.js"],"sourcesContent":["import React, { useEffect, useRef } from \"react\"\nimport PropTypes from \"prop-types\"\nimport * as maplibregl from \"maplibre-gl\"\nimport \"maplibre-gl/dist/maplibre-gl.css\"\n\nconst pageStyles = {\n  color: \"#232129\",\n  padding: 0,\n  fontFamily: \"-apple-system, Roboto, sans-serif, serif\",\n}\n\nconst Map = ({ zoom, center, minZoom, maxZoom }) => {\n  // this ref holds the map DOM node so that we can pass it into MapLibre GL\n  const mapNode = useRef(null)\n\n  // this ref holds the map object once we have instantiated it, so that we\n  // can use it in other hooks\n  const mapRef = useRef(null)\n\n  useEffect(() => {\n    let mapCenter = center\n    let mapZoom = zoom\n\n    const tileOptions = {\n        dark: 'https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json',\n        light: 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json',\n        voyager: 'https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json'\n    };\n\n    const map = new maplibregl.Map({\n      container: mapNode.current,\n      style: tileOptions['dark'], // style URL\n      center: mapCenter,\n      zoom: mapZoom,\n      minZoom,\n      maxZoom,\n    })\n    mapRef.current = map\n    // window.map = map // todo for easier debugging and querying via console\n\n    map.on(\"load\", async () => {\n        const response = await fetch('/static/bike_routes_heights.geojson');\n        if (!response.ok) {\n            throw new Error(`Response status: ${response.status}`);\n        }\n\n        const json = await response.json();\n        console.log(json);\n        console.log(json.features);\n        console.log(            {\n            type: 'geojson',\n            data: {\n                type: 'FeatureCollection',\n                features: json.features\n            }\n        });\n        map.addSource(\n            'seattle-bike-routes',\n            {\n                type: 'geojson',\n                data: {\n                    type: 'FeatureCollection',\n                    features: json.features\n                }\n            }\n        );\n\n        map.addLayer({\n            'id': 'route-line',\n            'type': 'line',\n            'source': 'seattle-bike-routes',\n            'paint': {\n                'line-color': ['get', 'line-color'],\n                'line-opacity': 0.8,\n                'line-width': 3\n            }\n        });\n\n        console.log('geolocating');\n        if (\"geolocation\" in navigator) {\n            navigator.geolocation.getCurrentPosition((position) => {\n                console.log('got position', position);\n                map.setCenter([position.coords.longitude, position.coords.latitude]);\n            });\n        }\n    })\n\n    return () => {\n      map.remove()\n    }\n  }, [])\n  return <div ref={mapNode} style={{ width: \"100vw\", height: \"100vh\" }} />\n}\n\nMap.propTypes = {\n  center: PropTypes.arrayOf(PropTypes.number),\n  zoom: PropTypes.number,\n}\n\nMap.defaultProps = {\n  center: [-122.332069, 47.606209],\n  zoom: 14,\n  minZoom: 2,\n}\n\nconst IndexPage = () => {\n  return (\n    <main style={pageStyles}>\n      <Map></Map>\n    </main>\n  )\n}\n\nexport default IndexPage\n\nexport const Head = () => <title>Bike Routes in Seattle</title>\n"],"names":["pageStyles","color","padding","fontFamily","Map","_ref","zoom","center","minZoom","maxZoom","mapNode","useRef","mapRef","useEffect","mapCenter","mapZoom","map","maplibregl","container","current","style","on","async","response","fetch","ok","Error","status","json","console","log","features","type","data","addSource","addLayer","navigator","geolocation","getCurrentPosition","position","setCenter","coords","longitude","latitude","remove","React","ref","width","height","defaultProps","IndexPage","Head"],"sourceRoot":""}